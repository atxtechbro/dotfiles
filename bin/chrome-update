#!/bin/bash
# Chrome update helper - direct and simple

echo "Chrome Update Tool"
echo "=================="

# Show current installed version
INSTALLED=$(dpkg -l | grep google-chrome-stable | awk '{print $3}')
echo "Installed: $INSTALLED"

# Update package lists
echo -e "\nUpdating package lists..."
sudo apt update

# Show available version
AVAILABLE=$(apt-cache policy google-chrome-stable | grep "Candidate:" | awk '{print $2}')
echo "Available: $AVAILABLE"

if [[ "$INSTALLED" == "$AVAILABLE" ]]; then
    echo -e "\n✅ Chrome is already up to date!"
    exit 0
fi

# Check if Chrome is running
if pgrep -f "chrome" > /dev/null; then
    echo -e "\n⚠️  Chrome appears to be running."
    echo "For best results, close Chrome before updating."
    read -p "Press Enter to continue anyway, or Ctrl+C to cancel..."
fi

# Perform the update
echo -e "\nUpdating Chrome..."
sudo apt install -y google-chrome-stable

# Show result
NEW_VERSION=$(dpkg -l | grep google-chrome-stable | awk '{print $3}')
echo -e "\n✅ Chrome package updated to: $NEW_VERSION"

if pgrep -f "chrome" > /dev/null; then
    echo -e "\n⚠️  Chrome is still running. Restart it to use the new version."
else
    echo -e "\nYou can now start Chrome with the new version."
fi