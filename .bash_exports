export FCEDIT=nvim
export EDITOR=nvim
export SUDO_EDITOR=nvim
export RUST_BACKTRACE=full

# Prevent unbound variable errors in Amazon Q integration
# Set to empty if not already defined
: ${WSL_DISTRO_NAME:=}
: ${Q_LOG_LEVEL:=}
: ${QTERM_SESSION_ID:=}
: ${TTY:=$(tty 2>/dev/null || echo "")}

# Load machine-specific exports FIRST (allows DOT_DEN override for custom clone locations)
# See README.md "Custom Clone Location" section for details
if [ -f ~/.bash_exports.local ]; then
    . ~/.bash_exports.local
fi

# Dotfiles root directory (required for claude alias and other tools)
# Override this in ~/.bash_exports.local if you cloned to a non-standard location
export DOT_DEN="${DOT_DEN:-$HOME/ppv/pillars/dotfiles}"

# Global MCP configuration path (required for claude alias)
export GLOBAL_MCP_CONFIG="$DOT_DEN/mcp/mcp.json"

# Add MCP wrapper scripts to PATH for cross-machine portability
export PATH="$PATH:$DOT_DEN/mcp"

# Source company-specific configuration from flywire-notes (gitignored)
if [ -f "$DOT_DEN/flywire-notes/bash-config.sh" ]; then
    source "$DOT_DEN/flywire-notes/bash-config.sh"
fi

# Default Patchright backend for Playwright (global, non-intrusive)
# If a user-level module alias exists at ~/.config/node-module-alias/node_modules,
# add it to NODE_PATH so that require('playwright') resolves to Patchright.
# This avoids wrapper scripts and per-repo code changes.
export PATCHRIGHT_MODULE_ROOT="$HOME/.config/node-module-alias/node_modules"
if [ -d "$PATCHRIGHT_MODULE_ROOT" ]; then
    case :$NODE_PATH: in
        *:$PATCHRIGHT_MODULE_ROOT:*) ;;
        *) export NODE_PATH="$PATCHRIGHT_MODULE_ROOT:${NODE_PATH}" ;;
    esac
fi
